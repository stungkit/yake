name: Test
on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]
  workflow_dispatch:

jobs:
    build:
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v4
        - name: Set up Python
          uses: actions/setup-python@v4
          with:
            python-version: '3.12'
        - name: Install uv
          run: pip install uv
        - name: Create virtual environment
          run: uv venv
        - name: Install dependencies
          run: |
            uv pip install -e ".[dev,lemmatization]"
            uv pip install pytest pytest-cov pytest-benchmark
        - name: Download spaCy and NLTK models
          run: |
            uv pip install https://github.com/explosion/spacy-models/releases/download/en_core_web_sm-3.7.1/en_core_web_sm-3.7.1-py3-none-any.whl
            uv run python -c "import nltk; nltk.download('wordnet', quiet=True); nltk.download('omw-1.4', quiet=True)"
        - name: test
          run: uv run pytest -vv --cov=yake tests/